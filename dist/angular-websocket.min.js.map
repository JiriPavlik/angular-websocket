{"version":3,"sources":["dist/angular-websocket.js"],"names":["global","factory","define","amd","exports","module","require","mod","angular","angularWebsocket","this","_angular","$WebSocketProvider","$rootScope","$q","$timeout","$websocketBackend","$WebSocket","url","protocols","options","isObject","isArray","undefined","ssl","test","scope","rootScopeFailover","useApplyAsync","initialTimeout","maxTimeout","reconnectIfNotNormalClose","binaryType","_reconnectAttempts","sendQueue","onOpenCallbacks","onMessageCallbacks","onErrorCallbacks","onCloseCallbacks","objectFreeze","_readyStateConstants","_connect","_setInternalState","prototype","CONNECTING","OPEN","CLOSING","CLOSED","RECONNECT_ABORTED","_normalCloseCode","_reconnectableStatusCodes","safeDigest","autoApply","$$phase","$digest","bindToScope","self","$on","force","socket","readyState","create","onmessage","bind","_onMessageHandler","onopen","_onOpenHandler","onerror","_onErrorHandler","onclose","_onCloseHandler","fireQueue","length","data","shift","send","isString","message","JSON","stringify","deferred","resolve","notifyOpenCallbacks","event","i","call","notifyCloseCallbacks","notifyErrorCallbacks","onOpen","cb","push","onClose","onError","onMessage","callback","isFunction","Error","isDefined","filter","RegExp","fn","pattern","$applyAsync","code","indexOf","reconnect","applyAsyncOrDigest","args","arraySlice","arguments","apply","currentCallback","exec","close","bufferedAmount","cancelableify","promise","cancel","then","reason","splice","reject","defer","isMocked","isConnected","mockSend","backoffDelay","_getBackoffDelay","backoffDelaySeconds","console","log","attempt","R","Math","random","T","N","M","floor","min","pow","state","objectDefineProperty","_internalConnectionState","forEach","pending","get","set","$WebSocketBackendProvider","$log","Socket","createWebSocketBackend","warn","Object","defineProperty","value","obj","__esModule","newObj","key","hasOwnProperty","default","window","WebSocket","MozWebSocket","noop","freeze","Array","slice","elt","len","from","Number","ceil","service"],"mappings":"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"}